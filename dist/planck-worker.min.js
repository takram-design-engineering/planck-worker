!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.Planck=e.Planck||{})}(this,function(e){"use strict";function r(e){var r=void 0,n=void 0;if("string"==typeof e)n=e,r=e;else{var t=Object.keys(e);r=e[n=y(t,1)[0]]}if(process.browser)return c.self[r];if("node"===c.type)try{return require(n)}catch(e){}}function n(e){try{return r(e)}catch(e){c.self.process={browser:"node"!==c.type}}return r(e)}function t(){switch(c.type){case"browser":var e=document.currentScript||document._currentScript;return e&&e.src||void 0;case"worker":return self.location.href;case"node":return __filename}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=Symbol(e);return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return void 0===e[r]&&(e[r]=n({})),e[r]}}function i(e,r){for(var n=arguments.length,t=Array(n>2?n-2:0),o=2;o<n;o++)t[o-2]=arguments[o];var i=this;return new Promise(function(n,o){var a=I(i),s=a.worker.worker;s.addEventListener("message",function t(u){if(u.data.uuid===r&&(u.data.error?o(new Error(u.data.error)):n(i.constructor.transform(u.data.result,e)),s.removeEventListener("message",t,!1),--a.running,a.running<0))throw new Error},!1),s.postMessage({property:e,uuid:r,args:t}),++a.running})}var a=function(){try{if(new Function("return this === window")())return"browser"}catch(e){}try{if(new Function("return this === self")())return"worker"}catch(e){}try{if(new Function("return this === global")())return"node"}catch(e){}}(),s=void 0;switch(a){case"browser":s=window;break;case"worker":s=self;break;case"node":s=global}var u,c={type:a,self:s},f="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l=function(e,r){return r={exports:{}},e(r,r.exports),r.exports}(function(e,r){function n(e,r){for(var n=0,t=e.length-1;t>=0;t--){var o=e[t];"."===o?e.splice(t,1):".."===o?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(r)for(;n--;n)e.unshift("..");return e}function t(e,r){if(e.filter)return e.filter(r);for(var n=[],t=0;t<e.length;t++)r(e[t],t,e)&&n.push(e[t]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return o.exec(e).slice(1)};r.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var i=o>=0?arguments[o]:process.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,r="/"===i.charAt(0))}return e=n(t(e.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+e||"."},r.normalize=function(e){var o=r.isAbsolute(e),i="/"===a(e,-1);return(e=n(t(e.split("/"),function(e){return!!e}),!o).join("/"))||o||(e="."),e&&i&&(e+="/"),(o?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(t(e,function(e,r){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},r.relative=function(e,n){function t(e){for(var r=0;r<e.length&&""===e[r];r++);for(var n=e.length-1;n>=0&&""===e[n];n--);return r>n?[]:e.slice(r,n-r+1)}e=r.resolve(e).substr(1),n=r.resolve(n).substr(1);for(var o=t(e.split("/")),i=t(n.split("/")),a=Math.min(o.length,i.length),s=a,u=0;u<a;u++)if(o[u]!==i[u]){s=u;break}for(var c=[],u=s;u<o.length;u++)c.push("..");return(c=c.concat(i.slice(s))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){var r=i(e),n=r[0],t=r[1];return n||t?(t&&(t=t.substr(0,t.length-1)),n+t):"."},r.basename=function(e,r){var n=i(e)[2];return r&&n.substr(-1*r.length)===r&&(n=n.substr(0,n.length-r.length)),n},r.extname=function(e){return i(e)[3]};var a="b"==="ab".substr(-1)?function(e,r,n){return e.substr(r,n)}:function(e,r,n){return r<0&&(r=e.length+r),e.substr(r,n)}}),v=(function(){function e(e){this.value=e}function r(r){function n(o,i){try{var a=r[o](i),s=a.value;s instanceof e?Promise.resolve(s.value).then(function(e){n("next",e)},function(e){n("throw",e)}):t(a.done?"return":"normal",a.value)}catch(e){t("throw",e)}}function t(e,r){switch(e){case"return":o.resolve({value:r,done:!0});break;case"throw":o.reject(r);break;default:o.resolve({value:r,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(e,r){return new Promise(function(t,a){var s={key:e,arg:r,resolve:t,reject:a,next:null};i?i=i.next=s:(o=i=s,n(e,r))})},"function"!=typeof r.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(e){return this._invoke("next",e)},r.prototype.throw=function(e){return this._invoke("throw",e)},r.prototype.return=function(e){return this._invoke("return",e)}}(),function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,n){function t(o,i){try{var a=r[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){t("next",e)},function(e){t("throw",e)});e(s)}return t("next")})}}),d=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},h=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),p=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},y=function(){function e(e,r){var n=[],t=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done)&&(n.push(a.value),!r||n.length!==r);t=!0);}catch(e){o=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(r,n){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(e){if(Array.isArray(e)){for(var r=0,n=Array(e.length);r<e.length;r++)n[r]=e[r];return n}return Array.from(e)},g={optional:function(e){var r=n(e);return void 0===r?{}:r},required:function(e){var r=n(e);if(void 0===r)throw"node"===c.type?new Error('Could not resolve module "'+e+'"'):new Error('"'+e+'" isn’t defined in the global scope');return r},browser:function(e){var r=n(e);if(void 0===r){if("node"!==c.type)throw new Error('"'+e+'" isn’t defined in the global scope');return{}}return r},node:function(e){var r=n(e);if(void 0===r){if("node"===c.type)throw new Error('Could not resolve module "'+e+'"');return{}}return r}}.node("path"),w=void 0,b=p({self:t(),get current(){return t()}},w="node"===c.type?{resolve:g.resolve,normalize:g.normalize,join:g.join,relative:g.relative,dirname:g.dirname,basename:g.basename,extname:g.extname,separator:g.sep,delimiter:g.delimiter}:{resolve:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return l.resolve.apply(l,["/"].concat(r))},normalize:l.normalize,join:l.join,relative:l.relative,dirname:l.dirname,basename:l.basename,extname:l.extname,separator:l.sep,delimiter:l.delimiter}),k=f.crypto||f.msCrypto;if(k&&k.getRandomValues){var x=new Uint8Array(16);u=function(){return k.getRandomValues(x),x}}if(!u){var A=new Array(16);u=function(){for(var e,r=0;r<16;r++)0==(3&r)&&(e=4294967296*Math.random()),A[r]=e>>>((3&r)<<3)&255;return A}}for(var j=u,E=[],M=0;M<256;++M)E[M]=(M+256).toString(16).substr(1);var P=function(e,r){var n=r||0,t=E;return t[e[n++]]+t[e[n++]]+t[e[n++]]+t[e[n++]]+"-"+t[e[n++]]+t[e[n++]]+"-"+t[e[n++]]+t[e[n++]]+"-"+t[e[n++]]+t[e[n++]]+"-"+t[e[n++]]+t[e[n++]]+t[e[n++]]+t[e[n++]]+t[e[n++]]+t[e[n++]]},S=j(),_=[1|S[0],S[1],S[2],S[3],S[4],S[5]],O=16383&(S[6]<<8|S[7]),z=0,L=0,T=function(e,r,n){var t=r&&n||0;"string"==typeof e&&(r="binary"==e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||j)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,r)for(var i=0;i<16;++i)r[t+i]=o[i];return r||P(o)},q=T;q.v1=function(e,r,n){var t=r&&n||0,o=r||[],i=void 0!==(e=e||{}).clockseq?e.clockseq:O,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),s=void 0!==e.nsecs?e.nsecs:L+1,u=a-z+(s-L)/1e4;if(u<0&&void 0===e.clockseq&&(i=i+1&16383),(u<0||a>z)&&void 0===e.nsecs&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");z=a,L=s,O=i;var c=(1e4*(268435455&(a+=122192928e5))+s)%4294967296;o[t++]=c>>>24&255,o[t++]=c>>>16&255,o[t++]=c>>>8&255,o[t++]=255&c;var f=a/4294967296*1e4&268435455;o[t++]=f>>>8&255,o[t++]=255&f,o[t++]=f>>>24&15|16,o[t++]=f>>>16&255,o[t++]=i>>>8|128,o[t++]=255&i;for(var l=e.node||_,v=0;v<6;++v)o[t+v]=l[v];return r||P(o)},q.v4=T;var C=q.v4,I=o("Worker"),R=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.name,t=r.path,o=void 0===t?b.self:t;d(this,e);var i=I(this);i.running=0,i.name=n||this.constructor.name,i.worker=new c.self.Worker(o),i.worker.postMessage(i.name)}return h(e,[{key:"get",value:function(e,r,n){return"running"===r?Reflect.get(this,r):i.bind(this,r,C())}},{key:"running",get:function(){return I(this).running}}],[{key:"transform",value:function(e){return e}},{key:"inverseTransform",value:function(e){return e}},{key:"new",value:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Proxy({},new(Function.prototype.bind.apply(this,[null].concat(r))))}}]),e}(),W=function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];d(this,e),this.message=r,this.list=n},F=o("WorkerInstance"),V=function(){function e(){d(this,e),F(this).handleMessage=this.handleMessage.bind(this)}return h(e,[{key:"start",value:function(){if("worker"!==c.type)throw new Error("Attempt to start worker instance on non-worker");var e=F(this);self.addEventListener("message",e.handleMessage,!1),console.log(this.constructor.name+" started")}},{key:"stop",value:function(){var e=F(this);self.removeEventListener("message",e.handleMessage,!1),console.log(this.constructor.name+" stopped")}},{key:"transfer",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];throw new W(e,r)}},{key:"handleMessage",value:function(){var e=v(regeneratorRuntime.mark(function e(r){var n,t,o,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.data,t=n.property,o=n.uuid,i=n.args,a=void 0,e.prev=2,e.next=5,Promise.resolve(this[t].apply(this,m(i)));case 5:a=e.sent,e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(2),!(e.t0 instanceof W)){e.next=14;break}a=e.t0,e.next=16;break;case 14:throw self.postMessage({uuid:o,error:e.t0.message||e.t0}),e.t0;case 16:a instanceof W?self.postMessage({uuid:o,result:a.message},a.list):self.postMessage({uuid:o,result:a});case 17:case"end":return e.stop()}},e,this,[[2,8]])}));return function(r){return e.apply(this,arguments)}}()}],[{key:"register",value:function(){var e=this;self.addEventListener("message",function r(n){n.data===e.name&&((new e).start(),self.removeEventListener("message",r,!1))},!1)}}]),e}();e.Worker=R,e.WorkerInstance=V,Object.defineProperty(e,"__esModule",{value:!0})});