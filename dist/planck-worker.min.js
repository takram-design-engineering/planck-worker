!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(r.Planck=r.Planck||{})}(this,function(r){"use strict";function e(r,e){return r(e={exports:{}},e.exports),e.exports}for(var s=e(function(r){var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var n=new Uint8Array(16);r.exports=function(){return e(n),n}}else{var t=new Array(16);r.exports=function(){for(var r,e=0;e<16;e++)0==(3&e)&&(r=4294967296*Math.random()),t[e]=r>>>((3&e)<<3)&255;return t}}}),o=[],n=0;n<256;++n)o[n]=(n+256).toString(16).substr(1);var a=function(r,e){var n=e||0,t=o;return[t[r[n++]],t[r[n++]],t[r[n++]],t[r[n++]],"-",t[r[n++]],t[r[n++]],"-",t[r[n++]],t[r[n++]],"-",t[r[n++]],t[r[n++]],"-",t[r[n++]],t[r[n++]],t[r[n++]],t[r[n++]],t[r[n++]],t[r[n++]]].join("")};var t=function(r,e,n){var t=e&&n||0;"string"==typeof r&&(e="binary"===r?new Array(16):null,r=null);var o=(r=r||{}).random||(r.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var i=0;i<16;++i)e[t+i]=o[i];return e||a(o)},i=function(){try{if(new Function("return this === window")())return!0}catch(r){}return!1}(),u=!i&&function(){try{if(new Function("return this === self")())return!0}catch(r){}return!1}(),f=!i&&!u&&function(){try{if(new Function("return this === global")())return!0}catch(r){}return!1}(),c=i?window:u?self:f?global:void 0,l={isBrowser:i,isWorker:u,isNode:f,scope:c},v=e(function(r,f){function o(r,e){for(var n=0,t=r.length-1;0<=t;t--){var o=r[t];"."===o?r.splice(t,1):".."===o?(r.splice(t,1),n++):n&&(r.splice(t,1),n--)}if(e)for(;n--;n)r.unshift("..");return r}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(r){return e.exec(r).slice(1)};function s(r,e){if(r.filter)return r.filter(e);for(var n=[],t=0;t<r.length;t++)e(r[t],t,r)&&n.push(r[t]);return n}f.resolve=function(){for(var r="",e=!1,n=arguments.length-1;-1<=n&&!e;n--){var t=0<=n?arguments[n]:process.cwd();if("string"!=typeof t)throw new TypeError("Arguments to path.resolve must be strings");t&&(r=t+"/"+r,e="/"===t.charAt(0))}return(e?"/":"")+(r=o(s(r.split("/"),function(r){return!!r}),!e).join("/"))||"."},f.normalize=function(r){var e=f.isAbsolute(r),n="/"===t(r,-1);return(r=o(s(r.split("/"),function(r){return!!r}),!e).join("/"))||e||(r="."),r&&n&&(r+="/"),(e?"/":"")+r},f.isAbsolute=function(r){return"/"===r.charAt(0)},f.join=function(){var r=Array.prototype.slice.call(arguments,0);return f.normalize(s(r,function(r,e){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},f.relative=function(r,e){function n(r){for(var e=0;e<r.length&&""===r[e];e++);for(var n=r.length-1;0<=n&&""===r[n];n--);return n<e?[]:r.slice(e,n-e+1)}r=f.resolve(r).substr(1),e=f.resolve(e).substr(1);for(var t=n(r.split("/")),o=n(e.split("/")),i=Math.min(t.length,o.length),s=i,a=0;a<i;a++)if(t[a]!==o[a]){s=a;break}var u=[];for(a=s;a<t.length;a++)u.push("..");return(u=u.concat(o.slice(s))).join("/")},f.sep="/",f.delimiter=":",f.dirname=function(r){var e=i(r),n=e[0],t=e[1];return n||t?(t&&(t=t.substr(0,t.length-1)),n+t):"."},f.basename=function(r,e){var n=i(r)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},f.extname=function(r){return i(r)[3]};var t="b"==="ab".substr(-1)?function(r,e,n){return r.substr(e,n)}:function(r,e,n){return e<0&&(e=r.length+e),r.substr(e,n)}}),p=(v.resolve,v.normalize,v.isAbsolute,v.join,v.relative,v.sep,v.delimiter,v.dirname,v.basename,v.extname,function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}),h=function(){function t(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),d=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}return r},g=function(r,e){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,e){var n=[],t=!0,o=!1,i=void 0;try{for(var s,a=r[Symbol.iterator]();!(t=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);t=!0);}catch(r){o=!0,i=r}finally{try{!t&&a.return&&a.return()}finally{if(o)throw i}}return n}(r,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},m=function(r){if(Array.isArray(r)){for(var e=0,n=Array(r.length);e<r.length;e++)n[e]=r[e];return n}return Array.from(r)};function y(r){var e=void 0,n=void 0;if("string"==typeof r)e=n=r;else{var t=Object.keys(r);e=r[n=g(t,1)[0]]}if(process.browser)return c[e];if(f)try{return require(n)}catch(r){}}function w(r){try{return y(r)}catch(r){c.process={browser:!f}}return y(r)}function b(r){var e=w(r);if(void 0===e){if(f)throw new Error('Could not resolve module "'+r+'"');return{}}return e}Object.assign(w,{optional:function(r){var e=w(r);return void 0===e?{}:e},required:function(r){var e=w(r);if(void 0===e)throw f?new Error('Could not resolve module "'+r+'"'):new Error('"'+r+'" isn’t defined in the global scope');return e},node:b,browser:function(r){var e=w(r);if(void 0===e){if(!f)throw new Error('"'+r+'" isn’t defined in the global scope');return{}}return e}});var k=b("path"),x=f?k:d({},v,{resolve:function(){for(var r=arguments.length,e=Array(r),n=0;n<r;n++)e[n]=arguments[n];return v.resolve.apply(v,["/"].concat(e))}}),A={resolve:x.resolve,normalize:x.normalize,join:x.join,relative:x.relative,dirname:x.dirname,basename:x.basename,extname:x.extname,delimiter:x.delimiter,sep:x.sep};function j(r){var n=Symbol(r);return function(r,e){return null==r[n]&&(r[n]="function"==typeof e?e({}):{}),r[n]}}var E=j("Worker");var M=function(){function i(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=r.name,n=r.path,t=void 0===n?A.self:n;p(this,i);var o=E(this);o.running=0,o.name=e||this.constructor.name,o.worker=new l.scope.Worker(t),o.worker.postMessage(o.name)}return h(i,[{key:"get",value:function(r,e,n){return"running"===e?Reflect.get(this,e):function(s,a){for(var r=arguments.length,e=Array(2<r?r-2:0),n=2;n<r;n++)e[n-2]=arguments[n];var u=this;return new Promise(function(n,t){var o=E(u),i=o.worker;i.addEventListener("message",function r(e){if(e.data.uuid===a&&(e.data.error?t(new Error(e.data.error)):n(u.constructor.transform(e.data.result,s)),i.removeEventListener("message",r,!1),--o.running,o.running<0))throw new Error},!1),i.postMessage({property:s,uuid:a,args:e}),++o.running})}.bind(this,e,t())}},{key:"running",get:function(){return E(this).running}}],[{key:"transform",value:function(r){return r}},{key:"inverseTransform",value:function(r){return r}},{key:"new",value:function(){for(var r=arguments.length,e=Array(r),n=0;n<r;n++)e[n]=arguments[n];return new Proxy({},new(Function.prototype.bind.apply(this,[null].concat(e))))}}]),i}(),P=function r(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];p(this,r),this.message=e,this.list=n},O=j("WorkerInstance"),C=function(){function r(){p(this,r),O(this).handleMessage=this.handleMessage.bind(this)}var e,n;return h(r,[{key:"start",value:function(){if(!l.isWorker)throw new Error("Attempt to start worker instance on non-worker");var r=O(this);self.addEventListener("message",r.handleMessage,!1),console.log(this.constructor.name+" started")}},{key:"stop",value:function(){var r=O(this);self.removeEventListener("message",r.handleMessage,!1),console.log(this.constructor.name+" stopped")}},{key:"transfer",value:function(r){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];throw new P(r,e)}},{key:"handleMessage",value:(e=regeneratorRuntime.mark(function r(e){var n,t,o,i,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.data,t=n.property,o=n.uuid,i=n.args,s=void 0,r.prev=2,r.next=5,Promise.resolve(this[t].apply(this,m(i)));case 5:s=r.sent,r.next=16;break;case 8:if(r.prev=8,r.t0=r.catch(2),!(r.t0 instanceof P)){r.next=14;break}s=r.t0,r.next=16;break;case 14:throw self.postMessage({uuid:o,error:r.t0.message||r.t0}),r.t0;case 16:s instanceof P?self.postMessage({uuid:o,result:s.message},s.list):self.postMessage({uuid:o,result:s});case 17:case"end":return r.stop()}},r,this,[[2,8]])}),n=function(){var a=e.apply(this,arguments);return new Promise(function(i,s){return function e(r,n){try{var t=a[r](n),o=t.value}catch(r){return void s(r)}if(!t.done)return Promise.resolve(o).then(function(r){e("next",r)},function(r){e("throw",r)});i(o)}("next")})},function(r){return n.apply(this,arguments)})}],[{key:"register",value:function(){var n=this;self.addEventListener("message",function r(e){e.data===n.name&&((new n).start(),self.removeEventListener("message",r,!1))},!1)}}]),r}();r.Worker=M,r.WorkerInstance=C,Object.defineProperty(r,"__esModule",{value:!0})});