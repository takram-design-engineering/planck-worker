!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.Planck=e.Planck||{})}(this,function(e){"use strict";function r(e){return process.browser?{}:"node"!==i.type?{}:require(e)}function n(){switch(i.type){case"browser":var e=document.currentScript||document._currentScript;return e?e.src:null;case"worker":return self.location.href;case"node":return __filename}throw new Error}function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=Symbol(e);return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return void 0===e[r]&&(e[r]=n({})),e[r]}}function o(){return M.v4()}function s(e,r){for(var n=arguments.length,t=Array(n>2?n-2:0),o=2;o<n;o++)t[o-2]=arguments[o];var s=this;return new Promise(function(n,o){var a=W(s),i=a.worker;i.addEventListener("message",function t(u){if(u.data.uuid===r&&(u.data.error?o(u.data.error):n(s.constructor.transform(u.data.result,e)),i.removeEventListener("message",t,!1),--a.running,a.running<0))throw new Error},!1),i.postMessage({property:e,uuid:r,args:t}),++a.running})}var a,i={get type(){try{if(new Function("return this === window")())return"browser"}catch(e){}try{if(new Function("return this === self")())return"worker"}catch(e){}try{if(new Function("return this === global")())return"node"}catch(e){}throw new Error},get self(){switch(this.type){case"browser":return window;case"worker":return self;case"node":return global}throw new Error},external:function(e){try{return r(e)}catch(e){i.self.process={browser:!0}}return r(e)}},u=n(),c={get self(){return u},get current(){return n()}},f="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l=f.crypto||f.msCrypto;if(l&&l.getRandomValues){var d=new Uint8Array(16);a=function(){return l.getRandomValues(d),d}}if(!a){var v=new Array(16);a=function(){for(var e,r=0;r<16;r++)0==(3&r)&&(e=4294967296*Math.random()),v[r]=e>>>((3&r)<<3)&255;return v}}for(var h=a,g=[],w=0;w<256;++w)g[w]=(w+256).toString(16).substr(1);var p=function(e,r){var n=r||0,t=g;return t[e[n++]]+t[e[n++]]+t[e[n++]]+t[e[n++]]+"-"+t[e[n++]]+t[e[n++]]+"-"+t[e[n++]]+t[e[n++]]+"-"+t[e[n++]]+t[e[n++]]+"-"+t[e[n++]]+t[e[n++]]+t[e[n++]]+t[e[n++]]+t[e[n++]]+t[e[n++]]},y=h(),m=[1|y[0],y[1],y[2],y[3],y[4],y[5]],k=16383&(y[6]<<8|y[7]),b=0,A=0,x=function(e,r,n){var t=r&&n||0;"string"==typeof e&&(r="binary"==e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||h)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,r)for(var s=0;s<16;++s)r[t+s]=o[s];return r||p(o)},E=x;E.v1=function(e,r,n){var t=r&&n||0,o=r||[],s=void 0!==(e=e||{}).clockseq?e.clockseq:k,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),i=void 0!==e.nsecs?e.nsecs:A+1,u=a-b+(i-A)/1e4;if(u<0&&void 0===e.clockseq&&(s=s+1&16383),(u<0||a>b)&&void 0===e.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");b=a,A=i,k=s;var c=(1e4*(268435455&(a+=122192928e5))+i)%4294967296;o[t++]=c>>>24&255,o[t++]=c>>>16&255,o[t++]=c>>>8&255,o[t++]=255&c;var f=a/4294967296*1e4&268435455;o[t++]=f>>>8&255,o[t++]=255&f,o[t++]=f>>>24&15|16,o[t++]=f>>>16&255,o[t++]=s>>>8|128,o[t++]=255&s;for(var l=e.node||m,d=0;d<6;++d)o[t+d]=l[d];return r||p(o)},E.v4=x;var M=E,P=function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,n){function t(o,s){try{var a=r[o](s),i=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});e(i)}return t("next")})}},C=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},L=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),R=function(e){if(Array.isArray(e)){for(var r=0,n=Array(e.length);r<e.length;r++)n[r]=e[r];return n}return Array.from(e)},W=t("Worker"),q=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.name,t=r.path,o=void 0===t?c.self:t;C(this,e);var s=W(this);s.running=0,s.name=n||this.constructor.name,s.worker=new i.self.Worker(o),s.worker.postMessage(s.name)}return L(e,[{key:"get",value:function(e,r,n){return"running"===r?Reflect.get(this,r):s.bind(this,r,o())}},{key:"running",get:function(){return W(this).running}}],[{key:"transform",value:function(e){return e}},{key:"inverseTransform",value:function(e){return e}},{key:"new",value:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Proxy({},new(Function.prototype.bind.apply(this,[null].concat(r))))}}]),e}(),F=(function(e,r){r={exports:{}},e(r,r.exports),r.exports}(function(e,r){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),t=0;t<e.length;t++)n[e.charCodeAt(t)]=t;r.encode=function(r){var n,t=new Uint8Array(r),o=t.length,s="";for(n=0;n<o;n+=3)s+=e[t[n]>>2],s+=e[(3&t[n])<<4|t[n+1]>>4],s+=e[(15&t[n+1])<<2|t[n+2]>>6],s+=e[63&t[n+2]];return o%3==2?s=s.substring(0,s.length-1)+"=":o%3==1&&(s=s.substring(0,s.length-2)+"=="),s},r.decode=function(e){var r,t,o,s,a,i=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var f=new ArrayBuffer(i),l=new Uint8Array(f);for(r=0;r<u;r+=4)t=n[e.charCodeAt(r)],o=n[e.charCodeAt(r+1)],s=n[e.charCodeAt(r+2)],a=n[e.charCodeAt(r+3)],l[c++]=t<<2|o>>4,l[c++]=(15&o)<<4|s>>2,l[c++]=(3&s)<<6|63&a;return f}}()}),i.external("text-encoding"),function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];C(this,e),this.message=r,this.list=n}),S=t("WorkerInstance"),U=function(){function e(){C(this,e),S(this).handleMessage=this.handleMessage.bind(this)}return L(e,[{key:"start",value:function(){if("worker"!==i.type)throw new Error("Attempt to start worker instance on non-worker");var e=S(this);self.addEventListener("message",e.handleMessage,!1),console.log(this.constructor.name+" started")}},{key:"stop",value:function(){var e=S(this);self.removeEventListener("message",e.handleMessage,!1),console.log(this.constructor.name+" stopped")}},{key:"transfer",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];throw new F(e,r)}},{key:"handleMessage",value:function(){var e=P(regeneratorRuntime.mark(function e(r){var n,t,o,s,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.data,t=n.property,o=n.uuid,s=n.args,a=void 0,e.prev=2,e.next=5,Promise.resolve(this[t].apply(this,R(s)));case 5:a=e.sent,e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(2),!(e.t0 instanceof F)){e.next=14;break}a=e.t0,e.next=16;break;case 14:throw self.postMessage({uuid:o,error:e.t0.message||e.t0}),e.t0;case 16:a instanceof F?self.postMessage({uuid:o,result:a.message},a.list):self.postMessage({uuid:o,result:a});case 17:case"end":return e.stop()}},e,this,[[2,8]])}));return function(r){return e.apply(this,arguments)}}()}],[{key:"register",value:function(){var e=this;self.addEventListener("message",function r(n){n.data===e.name&&((new e).start(),self.removeEventListener("message",r,!1))},!1)}}]),e}();e.Worker=q,e.WorkerInstance=U,Object.defineProperty(e,"__esModule",{value:!0})});