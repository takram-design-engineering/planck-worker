!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Planck={})}(this,function(e){"use strict";function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function n(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}function o(e){return decodeURIComponent(e.replace(/\+/g," "))}function i(e){var t,r={},n=void 0===(e=e||k.location||{})?"undefined":T(e);if("blob:"===e.protocol)r=new u(unescape(e.pathname),{});else if("string"===n){r=new u(e,{});for(t in Z)delete r[t]}else if("object"===n){for(t in e)t in Z||(r[t]=e[t]);void 0===r.slashes&&(r.slashes=K.test(e.href))}return r}function a(e){var t=J.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function s(e,t){for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],i=!1,a=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),a++):a&&(0===n&&(i=!0),r.splice(n,1),a--);return i&&r.unshift(""),"."!==o&&".."!==o||r.push(""),r.join("/")}function u(e,t,r){if(!(this instanceof u))return new u(e,t,r);var n,o,c,f,l,p,h=V.slice(),y=void 0===t?"undefined":T(t),v=this,d=0;for("object"!==y&&"string"!==y&&(r=t,t=null),r&&"function"!=typeof r&&(r=H.parse),t=i(t),n=!(o=a(e||"")).protocol&&!o.slashes,v.slashes=o.slashes||n&&t.slashes,v.protocol=o.protocol||t.protocol||"",e=o.rest,o.slashes||(h[2]=[/(.*)/,"pathname"]);d<h.length;d++)c=(f=h[d])[0],p=f[1],c!==c?v[p]=e:"string"==typeof c?~(l=e.indexOf(c))&&("number"==typeof f[2]?(v[p]=e.slice(0,l),e=e.slice(l+f[2])):(v[p]=e.slice(l),e=e.slice(0,l))):(l=c.exec(e))&&(v[p]=l[1],e=e.slice(0,l.index)),v[p]=v[p]||(n&&f[3]?t[p]||"":""),f[4]&&(v[p]=v[p].toLowerCase());r&&(v.query=r(v.query)),n&&t.slashes&&"/"!==v.pathname.charAt(0)&&(""!==v.pathname||""!==t.pathname)&&(v.pathname=s(v.pathname,t.pathname)),W(v.port,v.protocol)||(v.host=v.hostname,v.port=""),v.username=v.password="",v.auth&&(f=v.auth.split(":"),v.username=f[0]||"",v.password=f[1]||""),v.origin=v.protocol&&v.host&&"file:"!==v.protocol?v.protocol+"//"+v.host:"null",v.href=v.toString()}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=Symbol(e);return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return void 0===e[t]&&(e[t]=r({})),e[t]}}function f(e){this.message=e}function l(e){this.message=e}function p(e,t){return new Promise(function(r,n){var o=new be(e,!0);t.query&&o.set("query",Object.assign({},o.query,t.query));var i=new XMLHttpRequest;i.open("get",o.toString(),!0),t.headers&&Object.entries(t.headers).forEach(function(e){i.setRequestHeader.apply(i,B(e))}),i.responseType=t.type,i.addEventListener("loadend",function(e){i.status<200||i.status>=300?n(i.status):null!==i.response||"json"!==t.type?r(i.response):n(new Error("Could not parse JSON"))},!1),i.send()})}function h(e,t){return t.local?new Promise(function(r,n){ke(e,t.encoding,function(e,t){e?n(e):r(t)})}):new Promise(function(r,n){Ee({url:e,headers:t.headers||{},qs:t.query||{},encoding:t.encoding},function(e,t){e?n(e):((t.statusCode<200||t.statusCode>=300)&&n(t.statusCode),r(t.body))})})}function y(e,t){if("node"===de.type){var r=h(e,t);return"json"===t.type?r.then(function(e){if("string"!=typeof e)throw new Error("Response is unexpectedly not a string");return JSON.parse(e)}):"arraybuffer"===t.type?r.then(function(e){if(!(e instanceof Buffer))throw new Error("Response is unexpectedly not a buffer");for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;++n)r[n]=e[n];return t}):r}return p(e,t)}function v(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t[1];if("string"!=typeof n&&(n=(o=n).url),"string"!=typeof n)throw new Error("The first argument or options.url must be a string");return o=Object.assign({},{type:"text",local:!1,encoding:"utf-8"},o),[n,o]}function d(){return pe.v4()}function g(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var i=this;return new Promise(function(r,o){var a=qe(i),s=a.worker;s.addEventListener("message",function n(o){if(o.data.uuid===t&&(r(i.constructor.transform(o.data.result,e)),s.removeEventListener("message",n,!1),--a.running,a.running<0))throw new Error},!1),s.postMessage({property:e,uuid:t,args:n}),++a.running})}var w,m,b,k="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},E=t(function(e){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],i=0;i<4;i++)8*n+6*i<=8*e.length?r.push(t.charAt(o>>>6*(3-i)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,o=0;n<e.length;o=++n%4)0!=o&&r.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(e.charAt(n))>>>6-2*o);return r}};e.exports=r}()}),A={utf8:{stringToBytes:function(e){return A.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(A.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}},x=A,j=function(e){return null!=e&&(r(e)||n(e)||!!e._isBuffer)},T=(t(function(e){!function(){var t=E,r=x.utf8,n=j,o=x.bin,i=function e(i,a){i.constructor==String?i=a&&"binary"===a.encoding?o.stringToBytes(i):r.stringToBytes(i):n(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString());for(var s=t.bytesToWords(i),u=8*i.length,c=1732584193,f=-271733879,l=-1732584194,p=271733878,h=0;h<s.length;h++)s[h]=16711935&(s[h]<<8|s[h]>>>24)|4278255360&(s[h]<<24|s[h]>>>8);s[u>>>5]|=128<<u%32,s[14+(u+64>>>9<<4)]=u;for(var y=e._ff,v=e._gg,d=e._hh,g=e._ii,h=0;h<s.length;h+=16){var w=c,m=f,b=l,k=p;f=g(f=g(f=g(f=g(f=d(f=d(f=d(f=d(f=v(f=v(f=v(f=v(f=y(f=y(f=y(f=y(f,l=y(l,p=y(p,c=y(c,f,l,p,s[h+0],7,-680876936),f,l,s[h+1],12,-389564586),c,f,s[h+2],17,606105819),p,c,s[h+3],22,-1044525330),l=y(l,p=y(p,c=y(c,f,l,p,s[h+4],7,-176418897),f,l,s[h+5],12,1200080426),c,f,s[h+6],17,-1473231341),p,c,s[h+7],22,-45705983),l=y(l,p=y(p,c=y(c,f,l,p,s[h+8],7,1770035416),f,l,s[h+9],12,-1958414417),c,f,s[h+10],17,-42063),p,c,s[h+11],22,-1990404162),l=y(l,p=y(p,c=y(c,f,l,p,s[h+12],7,1804603682),f,l,s[h+13],12,-40341101),c,f,s[h+14],17,-1502002290),p,c,s[h+15],22,1236535329),l=v(l,p=v(p,c=v(c,f,l,p,s[h+1],5,-165796510),f,l,s[h+6],9,-1069501632),c,f,s[h+11],14,643717713),p,c,s[h+0],20,-373897302),l=v(l,p=v(p,c=v(c,f,l,p,s[h+5],5,-701558691),f,l,s[h+10],9,38016083),c,f,s[h+15],14,-660478335),p,c,s[h+4],20,-405537848),l=v(l,p=v(p,c=v(c,f,l,p,s[h+9],5,568446438),f,l,s[h+14],9,-1019803690),c,f,s[h+3],14,-187363961),p,c,s[h+8],20,1163531501),l=v(l,p=v(p,c=v(c,f,l,p,s[h+13],5,-1444681467),f,l,s[h+2],9,-51403784),c,f,s[h+7],14,1735328473),p,c,s[h+12],20,-1926607734),l=d(l,p=d(p,c=d(c,f,l,p,s[h+5],4,-378558),f,l,s[h+8],11,-2022574463),c,f,s[h+11],16,1839030562),p,c,s[h+14],23,-35309556),l=d(l,p=d(p,c=d(c,f,l,p,s[h+1],4,-1530992060),f,l,s[h+4],11,1272893353),c,f,s[h+7],16,-155497632),p,c,s[h+10],23,-1094730640),l=d(l,p=d(p,c=d(c,f,l,p,s[h+13],4,681279174),f,l,s[h+0],11,-358537222),c,f,s[h+3],16,-722521979),p,c,s[h+6],23,76029189),l=d(l,p=d(p,c=d(c,f,l,p,s[h+9],4,-640364487),f,l,s[h+12],11,-421815835),c,f,s[h+15],16,530742520),p,c,s[h+2],23,-995338651),l=g(l,p=g(p,c=g(c,f,l,p,s[h+0],6,-198630844),f,l,s[h+7],10,1126891415),c,f,s[h+14],15,-1416354905),p,c,s[h+5],21,-57434055),l=g(l,p=g(p,c=g(c,f,l,p,s[h+12],6,1700485571),f,l,s[h+3],10,-1894986606),c,f,s[h+10],15,-1051523),p,c,s[h+1],21,-2054922799),l=g(l,p=g(p,c=g(c,f,l,p,s[h+8],6,1873313359),f,l,s[h+15],10,-30611744),c,f,s[h+6],15,-1560198380),p,c,s[h+13],21,1309151649),l=g(l,p=g(p,c=g(c,f,l,p,s[h+4],6,-145523070),f,l,s[h+11],10,-1120210379),c,f,s[h+2],15,718787259),p,c,s[h+9],21,-343485551),c=c+w>>>0,f=f+m>>>0,l=l+b>>>0,p=p+k>>>0}return t.endian([c,f,l,p])};i._ff=function(e,t,r,n,o,i,a){var s=e+(t&r|~t&n)+(o>>>0)+a;return(s<<i|s>>>32-i)+t},i._gg=function(e,t,r,n,o,i,a){var s=e+(t&n|r&~n)+(o>>>0)+a;return(s<<i|s>>>32-i)+t},i._hh=function(e,t,r,n,o,i,a){var s=e+(t^r^n)+(o>>>0)+a;return(s<<i|s>>>32-i)+t},i._ii=function(e,t,r,n,o,i,a){var s=e+(r^(t|~n))+(o>>>0)+a;return(s<<i|s>>>32-i)+t},i._blocksize=16,i._digestsize=16,e.exports=function(e,r){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var n=t.wordsToBytes(i(e,r));return r&&r.asBytes?n:r&&r.asString?o.bytesToString(n):t.bytesToHex(n)}}()}),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}),O=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},S=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),q=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},P=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},C=function(){function e(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),B=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},M={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},R=function(e){throw{name:"SyntaxError",message:e,at:w,text:void 0}},_=function(e){return e&&e!==m&&R("Expected '"+e+"' instead of '"+m+"'"),m=(void 0).charAt(w),w+=1,m},F=function(){var e,t="";for("-"===m&&(t="-",_("-"));m>="0"&&m<="9";)t+=m,_();if("."===m)for(t+=".";_()&&m>="0"&&m<="9";)t+=m;if("e"===m||"E"===m)for(t+=m,_(),"-"!==m&&"+"!==m||(t+=m,_());m>="0"&&m<="9";)t+=m,_();if(e=+t,isFinite(e))return e;R("Bad number")},L=function(){var e,t,r,n="";if('"'===m)for(;_();){if('"'===m)return _(),n;if("\\"===m)if(_(),"u"===m){for(r=0,t=0;t<4&&(e=parseInt(_(),16),isFinite(e));t+=1)r=16*r+e;n+=String.fromCharCode(r)}else{if("string"!=typeof M[m])break;n+=M[m]}else n+=m}R("Bad string")},I=function(){for(;m&&m<=" ";)_()},U=function(){switch(m){case"t":return _("t"),_("r"),_("u"),_("e"),!0;case"f":return _("f"),_("a"),_("l"),_("s"),_("e"),!1;case"n":return _("n"),_("u"),_("l"),_("l"),null}R("Unexpected '"+m+"'")},D=function(){var e=[];if("["===m){if(_("["),I(),"]"===m)return _("]"),e;for(;m;){if(e.push(b()),I(),"]"===m)return _("]"),e;_(","),I()}}R("Bad array")},N=function(){var e,t={};if("{"===m){if(_("{"),I(),"}"===m)return _("}"),t;for(;m;){if(e=L(),I(),_(":"),Object.hasOwnProperty.call(t,e)&&R('Duplicate key "'+e+'"'),t[e]=b(),I(),"}"===m)return _("}"),t;_(","),I()}}R("Bad object")};b=function(){switch(I(),m){case"{":return N();case"[":return D();case'"':return L();case"-":return F();default:return m>="0"&&m<="9"?F():U()}};var W=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e},z=Object.prototype.hasOwnProperty,H={stringify:function(e,t){var r=[];"string"!=typeof(t=t||"")&&(t="?");for(var n in e)z.call(e,n)&&r.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return r.length?t+r.join("&"):""},parse:function(e){for(var t,r=/([^=?&]+)=?([^&]*)/g,n={};t=r.exec(e);n[o(t[1])]=o(t[2]));return n}},J=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,K=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,V=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Z={hash:1,query:1};u.prototype={set:function(e,t,r){var n=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||H.parse)(t)),n[e]=t;break;case"port":n[e]=t,W(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,/:\d+$/.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":n.pathname=t.length&&"/"!==t.charAt(0)?"/"+t:t;break;default:n[e]=t}for(var o=0;o<V.length;o++){var i=V[o];i[4]&&(n[i[1]]=n[i[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function(e){e&&"function"==typeof e||(e=H.stringify);var t,r=this,n=r.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var o=n+(r.slashes?"//":"");return r.username&&(o+=r.username,r.password&&(o+=":"+r.password),o+="@"),o+=r.host+r.pathname,(t="object"===T(r.query)?e(r.query):r.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(o+=r.hash),o}},u.extractProtocol=a,u.location=i,u.qs=H;var G,X=u,Q=t(function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<e.length;n++)r[e.charCodeAt(n)]=n;t.encode=function(t){var r,n=new Uint8Array(t),o=n.length,i="";for(r=0;r<o;r+=3)i+=e[n[r]>>2],i+=e[(3&n[r])<<4|n[r+1]>>4],i+=e[(15&n[r+1])<<2|n[r+2]>>6],i+=e[63&n[r+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,n,o,i,a,s=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var f=new ArrayBuffer(s),l=new Uint8Array(f);for(t=0;t<u;t+=4)n=r[e.charCodeAt(t)],o=r[e.charCodeAt(t+1)],i=r[e.charCodeAt(t+2)],a=r[e.charCodeAt(t+3)],l[c++]=n<<2|o>>4,l[c++]=(15&o)<<4|i>>2,l[c++]=(3&i)<<6|63&a;return f}}()}),Y=k.crypto||k.msCrypto;if(Y&&Y.getRandomValues){var $=new Uint8Array(16);G=function(){return Y.getRandomValues($),$}}if(!G){var ee=new Array(16);G=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),ee[t]=e>>>((3&t)<<3)&255;return ee}}for(var te=G,re=[],ne=0;ne<256;++ne)re[ne]=(ne+256).toString(16).substr(1);var oe=function(e,t){var r=t||0,n=re;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]},ie=te(),ae=[1|ie[0],ie[1],ie[2],ie[3],ie[4],ie[5]],se=16383&(ie[6]<<8|ie[7]),ue=0,ce=0,fe=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||te)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var i=0;i<16;++i)t[n+i]=o[i];return t||oe(o)},le=fe;le.v1=function(e,t,r){var n=t&&r||0,o=t||[],i=void 0!==(e=e||{}).clockseq?e.clockseq:se,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),s=void 0!==e.nsecs?e.nsecs:ce+1,u=a-ue+(s-ce)/1e4;if(u<0&&void 0===e.clockseq&&(i=i+1&16383),(u<0||a>ue)&&void 0===e.nsecs&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ue=a,ce=s,se=i;var c=(1e4*(268435455&(a+=122192928e5))+s)%4294967296;o[n++]=c>>>24&255,o[n++]=c>>>16&255,o[n++]=c>>>8&255,o[n++]=255&c;var f=a/4294967296*1e4&268435455;o[n++]=f>>>8&255,o[n++]=255&f,o[n++]=f>>>24&15|16,o[n++]=f>>>16&255,o[n++]=i>>>8|128,o[n++]=255&i;for(var l=e.node||ae,p=0;p<6;++p)o[n+p]=l[p];return t||oe(o)},le.v4=fe;var pe=le,he=c("AggregateFunction"),ye=function(){function e(t){if(O(this,e),t!==he)throw new Error;for(var r=he(this),n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];r.targets=o}return S(e,[{key:"apply",value:function(e,t,r){return he(this).targets.map(function(e){return Reflect.apply(e,t,r)})}},{key:"getPrototypeOf",value:function(e){return this.constructor.prototype}}],[{key:"new",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new(Function.prototype.bind.apply(this,[null].concat([he],t)));return new Proxy(function(){},n)}}]),e}(),ve=c("Aggregate");!function(){function e(t){if(O(this,e),t!==ve)throw new Error;for(var r=ve(this),n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];r.targets=o}S(e,[{key:"set",value:function(e,t,r,n){return ve(this).targets.forEach(function(e){Reflect.set(e,t,r)}),Reflect.set(e,t,r,n)}},{key:"get",value:function(e,t,r){var n=ve(this);return n.targets.every(function(e){return"function"==typeof Reflect.get(e,t)})?ye.new.apply(ye,B(n.targets.map(function(e){return Reflect.get(e,t).bind(e)}))):Reflect.get(n.targets[0],t,r)}},{key:"getPrototypeOf",value:function(e){return this.constructor.prototype}}],[{key:"new",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new(Function.prototype.bind.apply(this,[null].concat([ve],t)));return new Proxy({},n)}}])}();Object.setPrototypeOf(f,Error),(f.prototype=Object.create(Error.prototype)).name="AssertionError",f.prototype.message="",f.prototype.constructor=f;var de=function(){function e(){O(this,e)}return S(e,null,[{key:"type",get:function(){try{if(new Function("return this === window")())return"browser"}catch(e){}try{if(new Function("return this === self")())return"worker"}catch(e){}try{if(new Function("return this === global")())return"node"}catch(e){}throw new Error}},{key:"self",get:function(){switch(this.type){case"browser":return window;case"worker":return self;case"node":return global}throw new Error}}]),e}(),ge=c("FilePath"),we=function(){function e(){O(this,e)}return S(e,null,[{key:"self",get:function(){return ge(this).self}},{key:"current",get:function(){switch(de.type){case"browser":return window.location.href;case"worker":return self.location.href;case"node":return process.cwd()}throw new Error}}]),e}();ge(we).self=we.current,Object.setPrototypeOf(l,Error),(l.prototype=Object.create(Error.prototype)).name="ImplementationError",l.prototype.message="",l.prototype.constructor=l;var me=c("Multiton"),be=(function(){function e(t){if(O(this,e),this.constructor.has(t))throw new Error('Attempt to create multiple instances for key "'+t+'"')}S(e,null,[{key:"has",value:function(e){var t=me(this);if(void 0===t.instances)return!1;var r=this.coerceKey(e);return void 0!==t.instances[r]}},{key:"for",value:function(e){var t=me(this);t.instances||(t.instances=new Map);var r=this.coerceKey(e);if(t.instances.has(r))return t.instances.get(r);for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];var a=this.new.apply(this,[r].concat(o));return t.instances.set(r,a),a}},{key:"new",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new(Function.prototype.bind.apply(this,[null].concat([e],r)))}},{key:"coerceKey",value:function(e){return e}}])}(),function(e){function t(){return O(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return q(t,X),t}()),ke=void 0,Ee=void 0;if("node"===de.type){var Ae=require("fs");ke=Ae.readFile,Ee=require("request")}!function(){function e(){O(this,e)}S(e,null,[{key:"text",value:function(){var e=v.apply(void 0,arguments),t=C(e,2),r=t[0],n=t[1];return n.type="text",y(r,n)}},{key:"json",value:function(){var e=v.apply(void 0,arguments),t=C(e,2),r=t[0],n=t[1];return n.type="json",y(r,n)}},{key:"buffer",value:function(){var e=v.apply(void 0,arguments),t=C(e,2),r=t[0],n=t[1];return n.type="arraybuffer",n.encoding=null,y(r,n)}},{key:"csv",value:function(){var e=v.apply(void 0,arguments),t=C(e,2),r=t[0],n=t[1];return this.text(r,n).then(function(e){return de.self.d3.csvParse(e,n.row)})}},{key:"tsv",value:function(){var e=v.apply(void 0,arguments),t=C(e,2),r=t[0],n=t[1];return this.text(r,n).then(function(e){return de.self.d3.tsvParse(e,n.row)})}}])}();var xe=c("Semaphore"),je=function e(t,r){var n=this;O(this,e);var o=[new Promise(function(e,t){n.resolve=e,n.reject=t}),new Promise(function(e){n.let=e}).then(function(){r(n.resolve,n.reject)})];this.promise=Promise.all(o).then(function(e){return t.signal(),e[0]},function(e){return t.signal(),Promise.reject(e)})},Te=(function(){function e(t){O(this,e);var r=xe(this);r.capacity=t,r.available=t,r.queue=[]}S(e,[{key:"wait",value:function(e){var t=xe(this),r=new je(this,e);return 0===t.available?t.queue.push(r):(--t.available,r.let()),r.promise}},{key:"signal",value:function(){var e=xe(this);0===e.queue.length?++e.available:e.queue.shift().let()}},{key:"capacity",get:function(){return xe(this).capacity}},{key:"available",get:function(){return xe(this).available}}])}(),c("Singleton"));(function(){function e(){if(O(this,e),void 0!==Te(this.constructor).instance)throw new Error("Attempt to create multiple instances for singleton")}S(e,null,[{key:"get",value:function(){var e=Te(this);return void 0===e.instance&&(e.instance=this.new.apply(this,arguments)),e.instance}},{key:"new",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(this,[null].concat(t)))}}])})(),function(){function e(){O(this,e)}S(e,null,[{key:"transform",value:function(e,t,r){var n=[];return e.forEach(function(o,i){var a=i%t;if(n[a]=o,a===t-1)for(var s=r.apply(void 0,n.concat([Math.floor(i/t)])),u=0;u<t;++u)e[i-(t-u-1)]=s[u]}),e}},{key:"forEach",value:function(e,t,r){var n=[];e.forEach(function(e,o){var i=o%t;n[i]=e,i===t-1&&r.apply(void 0,n.concat([Math.floor(o/t)]))})}},{key:"some",value:function(e,t,r){var n=[];return e.some(function(e,o){var i=o%t;return n[i]=e,i===t-1&&r.apply(void 0,n.concat([Math.floor(o/t)]))})}},{key:"every",value:function(e,t,r){var n=[];return e.every(function(e,o){var i=o%t;return n[i]=e,i!==t-1||r.apply(void 0,n.concat([Math.floor(o/t)]))})}},{key:"reduce",value:function(e,t,r,n){var o=[];return e.reduce(function(e,n,i){var a=i%t;return o[a]=n,a===t-1?r.apply(void 0,[e].concat(o,[Math.floor(i/t)])):e},n)}}])}();if("node"===de.type){var Oe=require("text-encoding");void 0===de.self.TextEncoder&&(de.self.TextEncoder=Oe.TextEncoder),void 0===de.self.TextDecoder&&(de.self.TextDecoder=Oe.TextDecoder)}var Se=function(){function e(){O(this,e)}return S(e,null,[{key:"encode",value:function(e){if("function"!=typeof TextEncoder)throw new Error("TextEncoder is missing");var t=new TextEncoder,r=JSON.stringify(e);return t.encode(r).buffer}},{key:"decode",value:function(e){if("function"!=typeof TextDecoder)throw new Error("TextDecoder is missing");var t=new TextDecoder,r=new DataView(e),n=t.decode(r);return JSON.parse(n)}},{key:"pack",value:function(e){return Q.encode(e)}},{key:"unpack",value:function(e){return Q.decode(e)}},{key:"packBufferGeometry",value:function(e){var t=this;Object.values(e.data.attributes).forEach(function(e){var r=new(0,de.self[e.type])(e.array).buffer;e.array=t.pack(r)})}},{key:"unpackBufferGeometry",value:function(e){var t=this;Object.values(e.data.attributes).forEach(function(e){var r=de.self[e.type],n=t.unpack(e.array);e.array=Array.from(new r(n))})}}]),e}(),qe=c("Worker"),Pe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=t.path,o=void 0===n?we.self:n;O(this,e);var i=qe(this);i.running=0,i.name=r||this.constructor.name,i.worker=new de.self.Worker(o),i.worker.postMessage(i.name)}return S(e,[{key:"get",value:function(e,t,r){return"running"===t?Reflect.get(this,t):g.bind(this,t,d())}},{key:"running",get:function(){return qe(this).running}}],[{key:"transform",value:function(e){return e}},{key:"inverseTransform",value:function(e){return e}},{key:"new",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Proxy({},new(Function.prototype.bind.apply(this,[null].concat(t))))}}]),e}(),Ce=c("WorkerInstance"),Be=function(){function e(){O(this,e),Ce(this).handleMessage=this.handleMessage.bind(this)}return S(e,[{key:"start",value:function(){var e;if("worker"!==de.type)throw new Error;var t=Ce(this);(e=de.self).importScripts.apply(e,B(this.constructor.imports.map(function(e){return we.resolve(e)}))),de.self.addEventListener("message",t.handleMessage,!1),console.log(this.constructor.name+" started")}},{key:"stop",value:function(){var e=Ce(this);de.self.removeEventListener("message",e.handleMessage,!1),console.log(this.constructor.name+" stopped")}},{key:"post",value:function(e,t){de.self.postMessage({uuid:e,result:t})}},{key:"transfer",value:function(e,t){if(void 0===t)de.self.postMessage({uuid:e});else{var r=Se.encode(t);de.self.postMessage({uuid:e,result:r},[r])}}},{key:"handleMessage",value:function(e){var t=e.data,r=t.property,n=t.uuid,o=t.args;if("function"!=typeof this[r])throw new Error('Function was not found for "'+r+'"');this[r].apply(this,[n].concat(B(o)))}}],[{key:"register",value:function(){var e=this;de.self.addEventListener("message",function t(r){r.data===e.name&&((new e).start(),de.self.removeEventListener("message",t,!1))},!1)}},{key:"imports",get:function(){return[]}}]),e}();e.Worker=Pe,e.WorkerInstance=Be,Object.defineProperty(e,"__esModule",{value:!0})});